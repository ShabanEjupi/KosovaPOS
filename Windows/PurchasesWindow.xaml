<Window x:Class="KosovaPOS.Windows.PurchasesWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Blerjet - Purchases" Height="700" Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource BackgroundColor}">
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Style="{StaticResource ModernCard}" Margin="0,0,0,20">
            <StackPanel>
                <TextBlock Text="ðŸ›’ Menaxhimi i blerjeve" FontSize="28" FontWeight="Bold" 
                           Foreground="{StaticResource PrimaryColor}"/>
                <TextBlock Text="Regjistrimi dhe monitorimi i blerjeve nga furnizuesit" FontSize="14" 
                           Foreground="{StaticResource TextSecondary}" Margin="0,5,0,0"/>
            </StackPanel>
        </Border>
        
        <!-- Filters and Actions -->
        <Border Grid.Row="1" Style="{StaticResource ModernCard}" Margin="0,0,0,20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0" Text="Nga data:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <DatePicker Grid.Column="1" x:Name="FromDatePicker" Margin="0,0,20,0" 
                            FontSize="14" Height="35"/>
                
                <TextBlock Grid.Column="2" Text="Deri nÃ«:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <DatePicker Grid.Column="3" x:Name="ToDatePicker" Margin="0,0,20,0"
                            FontSize="14" Height="35"/>
                
                <Button Grid.Column="4" Content="ðŸ” Filtro" Style="{StaticResource ModernButton}"
                        Click="FilterButton_Click" Width="120" Margin="0,0,10,0"/>
                
                <Button Grid.Column="5" Content="âž• Blerje e re" Style="{StaticResource ModernButton}"
                        Click="NewPurchase_Click" Width="140" 
                        Background="{StaticResource SuccessColor}"/>
            </Grid>
        </Border>
        
        <!-- Purchases Content -->
        <Border Grid.Row="2" Style="{StaticResource ModernCard}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Summary Cards -->
                <Grid Grid.Row="0" Margin="0,0,0,20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <Border Grid.Column="0" Background="#9C27B0" CornerRadius="8" Padding="15" Margin="0,0,10,0">
                        <StackPanel>
                            <TextBlock Text="ðŸ’°" FontSize="24" HorizontalAlignment="Center"/>
                            <TextBlock Text="Blerjet totale" FontSize="12" Foreground="White" 
                                       HorizontalAlignment="Center" Margin="0,5,0,0"/>
                            <TextBlock x:Name="TotalPurchasesText" Text="0.00 â‚¬" FontSize="20" FontWeight="Bold" 
                                       Foreground="White" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                        </StackPanel>
                    </Border>
                    
                    <Border Grid.Column="1" Background="#FF9800" CornerRadius="8" Padding="15" Margin="0,0,10,0">
                        <StackPanel>
                            <TextBlock Text="â³" FontSize="24" HorizontalAlignment="Center"/>
                            <TextBlock Text="PÃ«r pagesÃ«" FontSize="12" Foreground="White" 
                                       HorizontalAlignment="Center" Margin="0,5,0,0"/>
                            <TextBlock x:Name="UnpaidAmountText" Text="0.00 â‚¬" FontSize="20" FontWeight="Bold" 
                                       Foreground="White" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                        </StackPanel>
                    </Border>
                    
                    <Border Grid.Column="2" Background="#4CAF50" CornerRadius="8" Padding="15" Margin="0,0,10,0">
                        <StackPanel>
                            <TextBlock Text="âœ…" FontSize="24" HorizontalAlignment="Center"/>
                            <TextBlock Text="TÃ« paguara" FontSize="12" Foreground="White" 
                                       HorizontalAlignment="Center" Margin="0,5,0,0"/>
                            <TextBlock x:Name="PaidAmountText" Text="0.00 â‚¬" FontSize="20" FontWeight="Bold" 
                                       Foreground="White" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                        </StackPanel>
                    </Border>
                    
                    <Border Grid.Column="3" Background="#2196F3" CornerRadius="8" Padding="15">
                        <StackPanel>
                            <TextBlock Text="ðŸ“¦" FontSize="24" HorizontalAlignment="Center"/>
                            <TextBlock Text="Numri i blerjeve" FontSize="12" Foreground="White" 
                                       HorizontalAlignment="Center" Margin="0,5,0,0"/>
                            <TextBlock x:Name="PurchaseCountText" Text="0" FontSize="20" FontWeight="Bold" 
                                       Foreground="White" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                        </StackPanel>
                    </Border>
                </Grid>
                
                <!-- Purchases DataGrid -->
                <DataGrid Grid.Row="1" x:Name="PurchasesDataGrid" 
                          Style="{StaticResource POSDataGrid}"
                          AutoGenerateColumns="False"
                          SelectionChanged="PurchasesDataGrid_SelectionChanged"
                          MouseDoubleClick="PurchasesDataGrid_MouseDoubleClick">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="60"/>
                        <DataGridTextColumn Header="Nr. Dokumentit" Binding="{Binding DocumentNumber}" Width="140"/>
                        <DataGridTextColumn Header="Data" Binding="{Binding Date, StringFormat=dd/MM/yyyy}" Width="120"/>
                        <DataGridTextColumn Header="Furnizuesi" Binding="{Binding Supplier.Name}" Width="*"/>
                        <DataGridTextColumn Header="Lloji" Binding="{Binding PurchaseType}" Width="120"/>
                        <DataGridTextColumn Header="Totali (â‚¬)" Binding="{Binding TotalAmount, StringFormat=N2}" Width="120"/>
                        <DataGridTextColumn Header="TVSH (â‚¬)" Binding="{Binding VATAmount, StringFormat=N2}" Width="100"/>
                        <DataGridCheckBoxColumn Header="Paguar" Binding="{Binding IsPaid}" Width="80"/>
                    </DataGrid.Columns>
                </DataGrid>
                
                <!-- Purchase Items -->
                <Expander Grid.Row="2" Header="Artikujt e blerjes" Margin="0,10,0,0">
                    <DataGrid x:Name="PurchaseItemsDataGrid" 
                              Style="{StaticResource POSDataGrid}"
                              AutoGenerateColumns="False"
                              MaxHeight="200">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Artikulli" Binding="{Binding Article.Name}" Width="*"/>
                            <DataGridTextColumn Header="Barkodi" Binding="{Binding Article.Barcode}" Width="120"/>
                            <DataGridTextColumn Header="Sasia" Binding="{Binding Quantity, StringFormat=N2}" Width="100"/>
                            <DataGridTextColumn Header="Ã‡mimi i blerjes" Binding="{Binding PurchasePrice, StringFormat=N2}" Width="130"/>
                            <DataGridTextColumn Header="TVSH %" Binding="{Binding VATRate, StringFormat=N0}" Width="80"/>
                            <DataGridTextColumn Header="Totali (â‚¬)" Binding="{Binding TotalValue, StringFormat=N2}" Width="120"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Expander>
            </Grid>
        </Border>
        
        <!-- Footer Buttons -->
        <Grid Grid.Row="3" Margin="0,20,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <Button Grid.Column="1" Content="ðŸ‘ï¸ Shiko" Style="{StaticResource ModernButton}"
                    Click="ViewPurchase_Click" Width="120" Margin="0,0,10,0"/>
            
            <Button Grid.Column="2" Content="âœï¸ Ndrysho" Style="{StaticResource ModernButton}"
                    Click="EditPurchase_Click" Width="120" Margin="0,0,10,0"/>
            
            <Button Grid.Column="3" Content="ðŸ’³ ShÃ«no si tÃ« paguar" Style="{StaticResource ModernButton}"
                    Click="MarkAsPaid_Click" Width="160" Margin="0,0,10,0"
                    Background="{StaticResource SuccessColor}"/>
            
            <Button Grid.Column="4" Content="ðŸ“Š Eksporto" Style="{StaticResource ModernButton}"
                    Click="ExportToExcel_Click" Width="120" Margin="0,0,10,0"/>
            
            <Button Grid.Column="5" Content="ðŸšª Mbyll" Style="{StaticResource ModernButton}"
                    Click="Close_Click" Width="120" 
                    Background="{StaticResource DangerColor}"/>
        </Grid>
    </Grid>
</Window>
